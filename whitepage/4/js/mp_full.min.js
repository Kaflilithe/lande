function emptyObject(obj) {
	for (var i in obj) {
		return false
	}
	return true
}
function AjaxSearch(id_input, in_block) {
	var globalTimeout = null;
	var _this = this;
	this.input = id_input;
	$(in_block).append('<div id="ajaxSearch_block"></div>');
	$(document).bind("click", function (e) {
		if (!$(e.target).parents().is("#ajaxSearch_block")) {
			_this.hideBlock()
		}
	});
	$(this.input).bind("keyup", function (e) {
		if (e.keyCode == 13 || e.keyCode == 37 || e.keyCode == 38 || e.keyCode == 39 || e.keyCode == 40 || e.keyCode == 27) {
			if ($("#ajaxSearch_block").find("li").length > 0) {
				switch (e.keyCode) {
					case 38:
						_this.Up();
						break;
					case 40:
						_this.Down();
						break;
					case 13:
						_this.Enter();
						break
				}
			}
			if (e.keyCode == 27) {
				_this.Esc()
			}
		} else {
			if ($(_this.input).val().length >= 3) {
				if (globalTimeout != null) {
					clearTimeout(globalTimeout)
				}
				globalTimeout = setTimeout(function () {
					if ($(_this.input).val() == "") {
						_this.hideBlock()
					} else {
						_this.getItems($(_this.input).val())
					}
				}, 1000)
			}
		}
	})
}
AjaxSearch.prototype.Up = function () {
	if ($("#ajaxSearch_block li.active").length > 0) {
		$("#ajaxSearch_block li:first").removeClass("active");
		$("#ajaxSearch_block li.active").removeClass("active").prev().addClass("active")
	} else {
		$("#ajaxSearch_block li:last").addClass("active")
	}
};
AjaxSearch.prototype.Down = function () {
	if ($("#ajaxSearch_block li.active").length > 0) {
		$("#ajaxSearch_block li:last").removeClass("active");
		$("#ajaxSearch_block li.active").removeClass("active").next().addClass("active")
	} else {
		$("#ajaxSearch_block li:first").addClass("active")
	}
};
AjaxSearch.prototype.Enter = function () {
	if ($("#ajaxSearch_block li.active").length > 0) {
		window.location = $("#ajaxSearch_block li.active a").attr("href");
		return false
	}
};
AjaxSearch.prototype.Esc = function () {
	$(this.input).val("");
	this.hideBlock()
};
AjaxSearch.prototype.showItems = function (text) {
	_this = this;
	if (!emptyObject(text)) {
		$("#ajaxSearch_block").html("<ul></ul>");
		$.each(text, function (key, val) {
			_this.pushItem(val)
		});
		$("#ajaxSearch_block").append('<a href="/catalog/search/?text=' + $(_this.input).val() + '">�������� ��� ���������� ������</a>');
		$("#ajaxSearch_block ul li").on("mouseover", function () {
			$("#ajaxSearch_block ul li.active").removeClass("active");
			$(this).addClass("active")
		});
		$("#ajaxSearch_block ul li").click(function () {
			window.location = $(this).find("a").attr("href")
		})
	} else {
		$("#ajaxSearch_block").html("������ �� �������")
	}
	this.showBlock()
};
AjaxSearch.prototype.pushItem = function (val) {
	$("#ajaxSearch_block ul").append("<li>" + (val.img ? "<img src='/img/catalog/item_" + val.id + "_s." + val.img + "' />" : "") + '<div><a href="/catalog/i/' + val.url + '.html">' + val.name + "</a><br />" + val.short_info + "<br /><span>" + val.price + " ���</span></div></li>")
};
AjaxSearch.prototype.showBlock = function (text) {
	$("#ajaxSearch_block").show()
};
AjaxSearch.prototype.hideBlock = function (text) {
	$("#ajaxSearch_block").hide()
};
AjaxSearch.prototype.getItems = function (text) {
	globalTimeout = null;
	_this = this;
	$.getJSON("/catalog/search/?ajax=1", {
		text: text
	}, function (data) {
		_this.showItems(data)
	})
};
var Base64 = {
	_keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
	encode: function (c) {
		var a = "";
		var k, h, f, j, g, e, d;
		var b = 0;
		c = Base64._utf8_encode(c);
		while (b < c.length) {
			k = c.charCodeAt(b++);
			h = c.charCodeAt(b++);
			f = c.charCodeAt(b++);
			j = k >> 2;
			g = ((k & 3) << 4) | (h >> 4);
			e = ((h & 15) << 2) | (f >> 6);
			d = f & 63;
			if (isNaN(h)) {
				e = d = 64
			} else {
				if (isNaN(f)) {
					d = 64
				}
			}
			a = a + this._keyStr.charAt(j) + this._keyStr.charAt(g) + this._keyStr.charAt(e) + this._keyStr.charAt(d)
		}
		return a
	},
	decode: function (c) {
		var a = "";
		var k, h, f;
		var j, g, e, d;
		var b = 0;
		c = c.replace(/[^A-Za-z0-9\+\/\=]/g, "");
		while (b < c.length) {
			j = this._keyStr.indexOf(c.charAt(b++));
			g = this._keyStr.indexOf(c.charAt(b++));
			e = this._keyStr.indexOf(c.charAt(b++));
			d = this._keyStr.indexOf(c.charAt(b++));
			k = (j << 2) | (g >> 4);
			h = ((g & 15) << 4) | (e >> 2);
			f = ((e & 3) << 6) | d;
			a = a + String.fromCharCode(k);
			if (e != 64) {
				a = a + String.fromCharCode(h)
			}
			if (d != 64) {
				a = a + String.fromCharCode(f)
			}
		}
		a = Base64._utf8_decode(a);
		return a
	},
	_utf8_encode: function (b) {
		b = b.replace(/\r\n/g, "\n");
		var a = "";
		for (var e = 0; e < b.length; e++) {
			var d = b.charCodeAt(e);
			if (d < 128) {
				a += String.fromCharCode(d)
			} else {
				if ((d > 127) && (d < 2048)) {
					a += String.fromCharCode((d >> 6) | 192);
					a += String.fromCharCode((d & 63) | 128)
				} else {
					a += String.fromCharCode((d >> 12) | 224);
					a += String.fromCharCode(((d >> 6) & 63) | 128);
					a += String.fromCharCode((d & 63) | 128)
				}
			}
		}
		return a
	},
	_utf8_decode: function (a) {
		var b = "";
		var d = 0;
		var e = c1 = c2 = 0;
		while (d < a.length) {
			e = a.charCodeAt(d);
			if (e < 128) {
				b += String.fromCharCode(e);
				d++
			} else {
				if ((e > 191) && (e < 224)) {
					c2 = a.charCodeAt(d + 1);
					b += String.fromCharCode(((e & 31) << 6) | (c2 & 63));
					d += 2
				} else {
					c2 = a.charCodeAt(d + 1);
					c3 = a.charCodeAt(d + 2);
					b += String.fromCharCode(((e & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
					d += 3
				}
			}
		}
		return b
	}
};

function base64_decode(h) {
	var d = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
	var c, b, a, m, l, k, j, n, g = 0,
		o = 0,
		e = "",
		f = [];
	if (!h) {
		return h
	}
	h += "";
	do {
		m = d.indexOf(h.charAt(g++));
		l = d.indexOf(h.charAt(g++));
		k = d.indexOf(h.charAt(g++));
		j = d.indexOf(h.charAt(g++));
		n = m << 18 | l << 12 | k << 6 | j;
		c = n >> 16 & 255;
		b = n >> 8 & 255;
		a = n & 255;
		if (k == 64) {
			f[o++] = String.fromCharCode(c)
		} else {
			if (j == 64) {
				f[o++] = String.fromCharCode(c, b)
			} else {
				f[o++] = String.fromCharCode(c, b, a)
			}
		}
	} while (g < h.length);
	e = f.join("");
	e = this.utf8_decode(e);
	return e
}
function base64_encode(g) {
	var d = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
	var c, b, a, l, k, j, h, m, f = 0,
		e = "";
	do {
		c = g.charCodeAt(f++);
		b = g.charCodeAt(f++);
		a = g.charCodeAt(f++);
		m = c << 16 | b << 8 | a;
		l = m >> 18 & 63;
		k = m >> 12 & 63;
		j = m >> 6 & 63;
		h = m & 63;
		e += d.charAt(l) + d.charAt(k) + d.charAt(j) + d.charAt(h)
	} while (f < g.length);
	switch (g.length % 3) {
		case 1:
			e = e.slice(0, -2) + "==";
			break;
		case 2:
			e = e.slice(0, -1) + "=";
			break
	}
	return e
}
function htmlspecialchars(c, h, g, b) {
	var e = 0,
		d = 0,
		f = false;
	if (typeof h === "undefined" || h === null) {
		h = 2
	}
	c = c.toString();
	if (b !== false) {
		c = c.replace(/&/g, "&amp;")
	}
	c = c.replace(/</g, "&lt;").replace(/>/g, "&gt;");
	var a = {
		ENT_NOQUOTES: 0,
		ENT_HTML_QUOTE_SINGLE: 1,
		ENT_HTML_QUOTE_DOUBLE: 2,
		ENT_COMPAT: 2,
		ENT_QUOTES: 3,
		ENT_IGNORE: 4
	};
	if (h === 0) {
		f = true
	}
	if (typeof h !== "number") {
		h = [].concat(h);
		for (d = 0; d < h.length; d++) {
			if (a[h[d]] === 0) {
				f = true
			} else {
				if (a[h[d]]) {
					e = e | a[h[d]]
				}
			}
		}
		h = e
	}
	if (h & a.ENT_HTML_QUOTE_SINGLE) {
		c = c.replace(/'/g, "&#039;")
	}
	if (!f) {
		c = c.replace(/"/g, "&quot;")
	}
	return c
}
function strip_tags(g, h) {
	var m = "",
		j = false;
	var f = [];
	var a = [];
	var l = "";
	var d = 0;
	var c = "";
	var e = "";
	var b = function (k, i, n) {
		return n.split(k).join(i)
	};
	if (h) {
		a = h.match(/([a-zA-Z0-9]+)/gi)
	}
	g += "";
	f = g.match(/(<\/?[\S][^>]*>)/gi);
	for (m in f) {
		if (isNaN(m)) {
			continue
		}
		e = f[m].toString();
		j = false;
		for (c in a) {
			l = a[c];
			d = -1;
			if (d != 0) {
				d = e.toLowerCase().indexOf("<" + l + ">")
			}
			if (d != 0) {
				d = e.toLowerCase().indexOf("<" + l + " ")
			}
			if (d != 0) {
				d = e.toLowerCase().indexOf("</" + l)
			}
			if (d == 0) {
				j = true;
				break
			}
		}
		if (!j) {
			g = b(e, "", g)
		}
	}
	return g
}
function nl2br(c, b) {
	var a = (b || typeof b === "undefined") ? "<br />" : "<br>";
	return (c + "").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, "$1" + a + "$2")
}


function getBodyScrollTop() {
	return self.pageYOffset || (document.documentElement && document.documentElement.scrollTop) || (document.body && document.body.scrollTop)
}
function getClientHeight() {
	if (document.documentElement.clientHeight && document.body.clientHeight) {
		if (document.documentElement.clientHeight < document.body.clientHeight) {
			return document.documentElement.clientHeight
		} else {
			return document.body.clientHeight
		}
	}
	return document.compatMode == "CSS1Compat" && !window.opera ? document.documentElement.clientHeight : document.body.clientHeight
}
function str_num125($num, $str1, $str2, $str5) {
	if ($num > 4 && $num < 21) {
		return $str5
	}
	$num = $num % 10;
	if ($num == 1) {
		return $str1
	}
	if ($num > 1 && $num < 5) {
		return $str2
	}
	return $str5
}
function sleep(timeout) {
	var loop = true;
	var current = new Date();
	var now;
	var cTimestamp = current.getTime();
	while (loop) {
		now = new Date();
		nTimestamp = now.getTime();
		if (nTimestamp - cTimestamp > timeout) {
			loop = false
		}
	}
}
function AddFormCart() {
	$("body").append('			<div id="div_cart">			<div class="cart_top"></div>			<div class="cart_left"><div class="cart_right"><div class="cart_body">			<span class="title_aj"> </span>			<div id="closeX">				<a href="#" onclick="$(\'#div_cart\').hide();$(\'#div_cart_shade\').hide(); return false;"></a>			</div>			<div id="cart_text"></div>			</div></div></div>			<div class="cart_bottom"></div>			</div><div id="div_cart_shade" onclick="$(\'#div_cart\').hide();$(\'#div_cart_shade\').hide()"></div>');
	$("#div_cart").css("top", getBodyScrollTop() + ((getClientHeight() / 2) - 200) + "px")
}
function AddItemToCart(id_item) {
	MyAnalytics.CartAddItem(id_item);
	$.getJSON(lang_url + "/catalog/cart/additem/" + id_item + "/ajax/", function (data) {
		if (data.msg) {
			$("#cart_count_place").text(data.count);
			$("#cart_summ_place").text(data.summ);
			$("#div_cart").css("top", getBodyScrollTop() + ((getClientHeight() / 2) - 200) + "px");
			$("#cart_text").load(lang_url + "/catalog/cart/?ajax=1", function () {
				$("#div_cart").show();
				$("#div_cart_shade").show()
			});
			$("#cart_item_preview .itemName a:first").html(data.item_name);
			$("#cart_item_preview .itemName a:first").attr("href", data.item_url);
			$("#cart_item_preview .itemName a:first").attr("href", data.item_url);
			$("#cart_item_preview img:first").attr("src", data.item_img_url);
			$("#cart_item_preview .itemPrice:first").html(data.item_price);
			$("#cart_item_preview").slideDown(400, function () {
				sleep(1000);
				$("#cart_item_preview").slideUp(400)
			})
		}
	})
}
function DecorCat(cat) {
	$("#info_decor_items a.decor-cats").removeClass("selected");
	$("#info_decor_items a.dcat_" + cat).addClass("selected");
	if (cat == "all") {
		$(".decor_items li").show();
		return false
	}
	$(".decor_items li").hide();
	$(".decor_items li.cat2_" + cat).show();
	return false
}
function InitIndexBanners() {
	if (!$("#big_banners").length) {
		return
	}
	$("#big_banners").flexslider({
		animation: "slide",
		animationLoop: true,
		directionNav: true,
		prevText: "����������",
		nextText: "���������",
		slideshow: true,
		slideshowSpeed: 7000
	})
}
$(document).ready(function () {
	$(".lang_link").click(function () {
		document.cookie = "lang=" + $(this).data("lang") + "; path=/; max-age=15768000";
		return true
	});
	$("span.hidden-link,p.hidden-link").each(function () {
		var _item = jQuery('<a href="' + $(this).attr("data-link") + '"' + ($(this).attr("oncl") ? ' onclick="' + $(this).attr("oncl") + '"' : "") + ">" + $(this).html() + "</a>");
		_item.attr("rel", $(this).attr("rel"));
		_item.attr("class", $(this).attr("class"));
		_item.attr("target", $(this).attr("target"));
		_item.click($(this).attr("onclick"));
		_item.removeClass("hidden-link");
		$(this).replaceWith(_item);
		return
	});
	InitGAEvents();
	InitIndexBanners()
});

function AddFormFastOrder() {
	$("body").append('			<div id="div_cart">			<div class="cart_top"></div>			<div class="cart_left"><div class="cart_right"><div class="cart_body">			<span class="title_aj"></span>			<div id="closeX">				<a href="#" onclick="$(\'#div_cart\').hide();$(\'#div_cart_shade\').hide(); return false;"></a>			</div>			<div id="cart_text"></div>			</div></div></div>			<div class="cart_bottom"></div>			</div><div id="div_cart_shade" onclick="$(\'#div_cart\').hide();$(\'#div_cart_shade\').hide()"></div>')
}
function FastOrder(id_item) {
	$.getJSON(lang_url + "/catalog/cart/additem/" + id_item + "/ajax/", function (data) {
		if (data.msg) {
			$("#cart_count_place").text(data.count);
			$("#cart_summ_place").text(data.summ);
			MyAnalytics.CartAddItem(id_item);
			$("#div_cart").css("top", getBodyScrollTop() + ((getClientHeight() / 2) - 200) + "px");
			$("#cart_text").load(lang_url + "/catalog/cart/?ajax=1", function () {
				$("#div_cart").show();
				$("#div_cart_shade").show()
			});
			$("#cart_item_preview .itemName a:first").html(data.item_name);
			$("#cart_item_preview .itemName a:first").attr("href", data.item_url);
			$("#cart_item_preview .itemName a:first").attr("href", data.item_url);
			$("#cart_item_preview img:first").attr("src", data.item_img_url);
			$("#cart_item_preview .itemPrice:first").html(data.item_price);
			$("#cart_item_preview").slideDown(400, function () {
				sleep(1000);
				$("#cart_item_preview").slideUp(400)
			})
		}
	})
}
function NumFilter(div_id) {
	this.div_id = div_id;
	this.leftLimit;
	this.leftValue;
	this.rightLimit;
	this.rightValue;
	this.base_price_url;
	this.slider_run_count = 1;
	this.need_update_page = false;
	this.from_div = "pricefrom";
	this.to_div = "priceto"
}
NumFilter.prototype.Init = function () {
	var _this = this;
	$(document).ready(function () {
		$("#slider").trackbar({
			onMove: function () {
				if ($("#pricefrom").html() != this.leftValue || $("#priceto").html() != this.rightValue) {
					_this.need_update_page = true
				}
				$("#pricefrom").html(this.leftValue);
				$("#priceto").html(this.rightValue);
				_this.slider_run_count--
			},
			width: 240,
			leftLimit: _this.leftLimit,
			leftValue: _this.leftValue,
			rightLimit: _this.rightLimit,
			rightValue: _this.rightValue,
			clearLimits: true,
			clearValues: true
		});
		$.trackbar.getObject().addHandler(document, "mouseup", function () {
			if (_this.need_update_page) {
				window.location = _this.base_price_url.replace("**price_from**", $("#pricefrom").html()).replace("**price_to**", $("#priceto").html())
			}
		})
	})
};

function InitFilterClick(base_url) {
	$(document).ready(function () {
		$(".fil_chek .sss_h").each(function () {
			var html = $(this).html();
			var url = base_url;
			if ($(this).data("br")) {
				url += "br/" + $(this).data("br") + "/"
			}
			if ($(this).data("f")) {
				url += "f/" + $(this).data("f").replace(/\/\*\*\//g, "/f/") + "/";
				url = url.replace(/\/\*\*\//g, "/f/")
			}
			if ($(this).data("data-pricefrom")) {
				url += "price_from/" + $(this).data("pricefrom") + "/"
			}
			if ($(this).data("priceto")) {
				url += "price_to/" + $(this).data("priceto") + "/"
			}
			html = '<a href="' + url + '">' + html + "</a>";
			$(this).replaceWith(html)
		})
	})
}
function ItemWait() {
	var id_item = $(this).attr("id_item");
	var CloseClick = function () {
		$("#shadow").fadeOut().unbind("click");
		$("#item_wait_" + id_item).fadeOut()
	};
	if ($("#item_wait_" + id_item).get(0)) {
		$("#item_wait_" + id_item).fadeIn();
		$("#shadow").click(CloseClick).fadeIn();
		return false
	}
	var html = "";
	$(this).after(html);
	$("#item_wait_" + id_item + " input[name=phone]").mask("+38 (0n9) 999-9999");
	$("#item_wait_" + id_item + " .btn").click(CloseClick);
	if (id_user) {
		$("#item_wait_" + id_item + " form").submit(ItemWaitAuth);
		$("#item_wait_" + id_item + " form").submit()
	} else {
		$("#item_wait_" + id_item + " form").submit(ItemWaitNotAuth);
		$("#item_wait_" + id_item).fadeIn();
		$("#shadow").click(CloseClick).fadeIn()
	}
	return false
}

function InitSort(sort, sorts) {
	if (!sort) {
		sort = "default"
	}
	var html = '<div id="sorting">';
	var _url = $("#sort_link").attr("href");
	html += '<div class="head"></div>';
	html += '<div class="left_shadow">';
	html += '<div class="right_shadow">';
	html += '<div class="body">';
	for (i in sorts) {
		html += '<a href="' + _url + (i == "default" ? "" : "?s=" + i) + '" sort="' + i + '"' + (sort == i ? ' class="active"' : "") + ">" + sorts[i] + "</a>"
	}
	html += "</div>";
	html += "</div>";
	html += "</div>";
	html += '<div class="foot"></div>';
	html += "</div>";
	$("#sort_link").after(html);
	$("#sort_link").click(function () {
		$("#sorting").fadeIn();
		return false
	})
}
$(document).ready(function () {
	var show_menu = {};
	$("#desctop_catmenu>li").hover(function () {
		show_menu[this.id] = true;
		var _this = this;
		setTimeout(function () {
			if (!show_menu[_this.id]) {
				return
			}
			$(_this).find(".dropbox").show()
		}, 100)
	}, function () {
		show_menu[this.id] = false;
		$(this).find(".dropbox").hide()
	});
	$("#tabs.item_tabs a").click(function () {
		$(".itemWrapper #tabs li").removeClass("current");
		$(this).parent().addClass("current");
		$("div.item_info").hide();
		$("#info_" + this.rel).show();
		window.location = "#" + this.rel;
		return false
	});
	if ($("#cat_items_sort").get(0)) {
		InitSort($("#cat_items_sort a.popup_sort").attr("sort"), {
			"default": "������������",
			priceup: "����������� ����",
			pricedown: "�������� ����",
			itemsdown: "���������� ���������",
			"new": "�������"
		})
	}
});


function SubscribePopupFormClick() {
	var name = $(this).parents("form").find("input[name=name]").val();
	var email = $(this).parents("form").find("input[name=email]").val();
	var error = false;
	if (!name) {
		alert("������� ���� ���");
		$(this).parents("form").find("input[name=name]").focus();
		error = true
	}
	if (!error && !email) {
		alert("������� ��� E-mail");
		$(this).parents("form").find("input[name=email]").focus();
		error = true
	}
	if (!error) {
		$.getJSON("/?mod=subscription&sub=subscribe&ajax=1&lists[]=1", {
			name: name,
			email: email,
			formtype: "popup_form"
		}, function (data) {
			if (data.status == "ok") {
				HidePopupSubscribeForm()
			}
			alert(data.msg)
		})
	}
	return false
}
function HidePopupSubscribeForm() {
	$("#popup_subscribe").hide();
	$("#popup_subscribe_shade").hide();
	return false
}
function ShowPopupSubscribeForm() {
	if (!$("#popup_subscribe").get(0)) {
		$("body").append('			<div id="popup_subscribe">			<div class="cart_top"></div>			<div class="cart_left"><div class="cart_right"><div class="cart_body">			<div id="closeX">				<a href="#" onclick="HidePopupSubscribeForm(); return false;"></a>			</div>			<div id="cart_text">				<span class="title">����������� �� �������� �������� � �����</span>				<form action="">					<label>���� ���</label><input type="text" name="name" value=""/><br/>					<label>��� email</label><input type="text" name="email" value=""/><br/>					<a href="#" class="bt_subscribe">�����������</a>				</form>			</div>			</div></div></div>			<div class="cart_bottom"></div>			</div><div id="popup_subscribe_shade" onclick="HidePopupSubscribeForm()"></div>');
		$("#popup_subscribe .bt_subscribe").click(SubscribePopupFormClick)
	}
	$("#popup_subscribe").css("top", (getBodyScrollTop() + ((getClientHeight() / 2) - 200)) + "px");
	$("#popup_subscribe,#popup_subscribe_shade").show();
	console.log(getBodyScrollTop());
	console.log(getClientHeight())
}
$(document).ready(function () {
	AddFormCart()
});
$(document).ready(function () {

	$("#subscribe .bt_subscribe").after('<input type="submit" style="display: none;">');
	
	$("a.remindBtn").click(ItemWait)
});
$(document).ready(function () {
	var html = "";
	$("ul.menu").after(html);
	$("#enter_a").click(function () {
		$("#shadow").fadeIn();
		$("#auth").fadeIn();
		return false
	});
	$("#exit_a").click(function () {
		$("#shadow").fadeOut();
		$("#auth").fadeOut();
		return false
	})
});
AjaxSearch.prototype.pushItem = function (val) {
	$("#ajaxSearch_block ul").append("<li>" + (val.img ? "<img src='" + val.img_list_url + "' />" : "") + '<div><a href="' + lang_url + "/catalog/i/" + val.url + '.html">' + val.name + "</a>" + (val.short_info ? "<br />" + val.short_info : "") + "<br /> �������: <strong>" + val.id_formated + "</strong><br /><span>" + val.price + " ���</span></div></li>")
};

function liveTexOfflineMyCallBack() {
	var livetexChatParams = {
		site_id: liveSettings.id_site,
		session: liveSettings.id_session
	},
		http = /https/.test(document.location.href) ? "https" : "http",
		encodeFormData = function (obj) {
			return tokenizeUrlData(obj).join("&")
		};
	var safarifix = "height=604",
		openWindowOnDoubleClick = false;
	if ((navigator.appVersion.indexOf("Safari") != -1) && (navigator.appVersion.indexOf("Chrome") == -1)) {
		if (navigator.appVersion.indexOf("Mac OS X") != -1) {
			safarifix = "height=604"
		} else {
			safarifix = "height=545"
		}
	}
	var isMobile = {
		Android: function () {
			return navigator.userAgent.match(/Android/i)
		},
		BlackBerry: function () {
			return navigator.userAgent.match(/BlackBerry/i)
		},
		iOS: function () {
			return navigator.userAgent.match(/iPhone|iPad|iPod/i)
		},
		Opera: function () {
			return navigator.userAgent.match(/Opera Mini/i)
		},
		Windows: function () {
			return navigator.userAgent.match(/IEMobile/i)
		},
		any: function () {
			return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows())
		}
	};
	var windowSettings = [];
	if (isMobile.any()) {
		windowSettings = ["status=0", "toolbar=0", "menubar=0", "scrollbars=0", "location=0"].join(",")
	} else {
		windowSettings = ["status=0", "toolbar=0", "menubar=0", "resizable=0", "scrollbars=0", safarifix, "width=447", "top=20", "left=20", "location=0", "resize=0"].join(",")
	}
	var tokenizeUrlData = function (object, opt_path) {
		var result = [];
		if (opt_path === undefined) {
			opt_path = []
		}
		if (typeof object === "object") {
			for (var key in object) {
				var newPath = opt_path.length === 0 ? [key] : (opt_path.join(",") + "," + key).split(",");
				result = result.concat(tokenizeUrlData(object[key], newPath))
			}
		} else {
			result = [opt_path.shift() + (opt_path.length > 0 ? "[" + opt_path.join("][") + "]=" : "=") + encodeURIComponent(String(object))]
		}
		return result
	};
	var contentServer = ("stable" === liveSettings.stable) ? liveSettings.cServer2.replace(/http(?=:)/, http) : (http + "://" + window.LTX_STATIC_HOST + ":" + window.livetexTest + "/");
	var getChatWindowUrl = function (type) {
		if (http === "https") {
			contentServer.replace(/\:[0-9]+/, "")
		}
		return contentServer + type + "/?" + encodeFormData(livetexChatParams)
	};
	_openWindowWithCheck = function (link, windowType, windowSettings, callback) {
		if (openWindowOnDoubleClick) {
			return
		}
		openWindowOnDoubleClick = true;
		currentW = window.open(link, windowType, windowSettings);
		openWindowOnDoubleClick = false;
		if (callback) {
			callback(currentW)
		}
	};
	var url = window.liveSettings.lid ? getChatWindowUrl("biglead") : getChatWindowUrl("offline");
	_openWindowWithCheck(url, "chatWindow", windowSettings);
	return true
}
$(document).ready(function () {
	$(".nav-trigger:not(.trigger_2)").click(function () {
		$(".hBrandsMenu .hb_menu_navbar .flex_wrapper").slideToggle();
		$(".hidden_phones").fadeOut();
		$(this).toggleClass("is-active");
		$(this).find("i").toggleClass("rotated_i")
	});
	$(".nav-trigger.trigger_2").click(function () {
		$(this).toggleClass("is-active");
		$(".menu").slideToggle();
		if ($(".menu").hasClass("is_opened")) {
			$(".menu").removeClass("is_opened");
			$(".menu").css({
				left: "-300px"
			});
			$(this).removeClass("is-active")
		} else {
			$(".menu").css({
				left: "0px"
			});
			$(this).addClass("is-active");
			$(".menu").addClass("is_opened")
		}
	});
	$(".submenu_close").click(function () {
		var parent = $(this).parent();
		parent.css("display", "none")
	});
	$(".mobile_phones").click(function () {
		$(".hidden_phones").fadeToggle();
		$(".hBrandsMenu .hb_menu_navbar .flex_wrapper").slideUp()
	});
	$(".mobile_toggle_button").click(function () {
		$(".mobile_toggle").slideToggle();
		$(".mobile_toggle_button").toggleClass("toggle_opened");
		$(this).hasClass("toggle_opened") ? $(this).text("������ �����") : $(this).text("�������� �����")
	});
	$(window).bind("ready", function () {
		if ($(window).width() < 992) {
			$("a.nazad").text("�����");
			$("a.dalshe").text("������");
			$("#search_block input.submit").val("������");
			if ($("*").is($(".sideBar")) && $(".sideBar").children().is($("#filters"))) {
				$("#column_trigger").after("<div class='open_side filters_side'>������� <i class=\"rotatable_i fas fa-angle-down\"></i></div>");
				$(".open_side.filters_side").on("click", function () {
					$(".sideBar").slideToggle();
					$(this).find(".rotatable_i").toggleClass("rotated_i")
				});
				$("#filters div.body span.title").click(function () {
					$(this).parent().find(".fil_chek").slideToggle();
					if ($(this).parent().find(".priceI,#slider")) {
						$(this).parent().find(".priceI,#slider").slideToggle()
					}
				})
			} else {
				if ($("*").is($(".sideBar")) && $(".sideBar").children().is($("#articles"))) {
					$(".sideBar").addClass("action_sidebar");
					if ($(".content").children().is($(".uslugi_page"))) {
						$(".fSort").after("<div class='open_side more_side action_side'>��� ������ <i class=\"rotatable_i fas fa-angle-down\"></i></div>")
					} else {
						$(".fSort").after("<div class='open_side more_side action_side'>��� ����� <i class=\"rotatable_i fas fa-angle-down\"></i></div>")
					}
					$(".open_side.more_side").on("click", function () {
						$(".sideBar").slideToggle();
						$(this).find(".rotatable_i").toggleClass("rotated_i")
					})
				}
			}
		} else {
			$("#search_block input.submit").val("")
		}
		if ($(window).width() <= 380) {
			$(".hi_wrap").remove()
		}
	});
	if ($(window).width() < 650) {
		var si_price_old = $(".moneyDiv .price_old,.moneyDiv .cashback_summ").detach();
		$(".moneyDiv").after(si_price_old);
		$("a#profile").html('<i class="fas fa-user"></i>');
		$("a#exit_url").html('<i class="fas fa-sign-out-alt"></i>');
		var temp = $(".sort_wrap").detach();
		$("#column_trigger").after(temp);
		$(".sort_wrap .popup_sort").after('<i class="rotatable_i fas fa-angle-down"></i>');
		$(".sort_wrap").addClass("open_side os_expanded");
		$("#sorting").addClass("sorting_mobile");
		$(".sort_wrap").click(function () {
			$("#sorting").slideToggle();
			$(this).find(".rotatable_i").toggleClass("rotated_i")
		});
		$(".cart_table .cart_table_td_summ b:not(.all)").parent().remove();
		$(".cart_table .cart_table_td_summ").eq(0).text(" ");
		$(".cart_table .cart_table_td_del").eq(0).remove();
		$(".cart_table .cart_table_td_del").last().remove();
		$(".cart_table .cart_table_td_del a").html('<i class="fas fa-times-circle"></i>')
	}
	$(".sideBar, .content").wrapAll('<div class="content_wrap flex_wrapper"></div>');
	$(".text_page").parents("body").find(".content").wrap("<div class='container_p'></div>");
	$("#tr_phone .mt_right input").attr("type", "tel");
	$("#column_trigger").click(function () {
		$(this).parents(".content").toggleClass("column_1_content")
	});
	$(".mp_phone a").each(function () {
		var some = $(this).text();
		for (var i = 0; i < some.length; i++) {
			some = some.replace("(", "").replace(")", "").replace("-", "").replace(" ", "")
		}
		some = "tel:+38" + some;
		$(this).attr("href", some)
	});
	$(".menu_mobile_cats .nav-trigger").click(function () {
		if ($("#mobile_catmenu").hasClass("is_open")) {
			$("#mobile_catmenu").removeClass("is_open");
			$(".menu_mobile_cats").removeClass("is_open");
			$("#mobile_catmenu").css("display", "none")
		} else {
			$(".menu_mobile_cats").addClass("is_open");
			$("#mobile_catmenu").addClass("is_open");
			$("#mobile_catmenu").css("display", "block")
		}
	});
	var dropboxes = $(".hBrandsMenu .drop_col_3");
	dropboxes.each(function () {
		if ($(this).find("ul").length > 2) {
			$(this).addClass("dropbox_center")
		}
	})
});
$(document).ready(function () {
	objAjaxSearch = new AjaxSearch("#ajaxsearch", "div.header", "���")
});

function MyAnalyticsClass() { }
MyAnalyticsClass.prototype.Error404 = function () {
	ga("send", "event", "Error", "Error404", {
		eventLabel: document.referrer,
		nonInteraction: 1
	})
};
MyAnalyticsClass.prototype.CommentAdd = function (_item_name) {
	ga("send", "event", "Item", "CommentAdd", "", 0)
};
MyAnalyticsClass.prototype.ItemLike = function (_item_name) {
	ga("send", "event", "Item", "ItemLike", "", 0)
};
MyAnalyticsClass.prototype.WaitItemDone = function () {
	ga("send", "event", "WaitItem", "WaitItemDone", "", 0)
};
MyAnalyticsClass.prototype.CartAddItem = function (additem) { };
MyAnalyticsClass.prototype.CartTryPost = function () {
	ga("send", "event", "Cart", "CartTryPost", "", 0)
};
MyAnalyticsClass.prototype.CartOrderPost = function () {
	ga("send", "event", "Cart", "CartOrderPost", "", 0)
};
MyAnalyticsClass.prototype.CartErrorFields = function (fields) {
	ga("send", "event", "Cart", "ErrorFields", fields, 0)
};
MyAnalyticsClass.prototype.PageView = function (url) {
	ga("set", "page", url);
	ga("send", "pageview")
};
MyAnalyticsClass.prototype.OpenChat = function () {
	ga("send", "event", "Chat", "OpenChat", "", 0)
};
MyAnalyticsClass.prototype.SetIdClient = function (id_client) {
	ga("set", "dimension6", id_client);
	ga("set", "userId", id_client)
};
MyAnalyticsClass.prototype.InitLivetexEvents = function (LiveTex) {
	LiveTex.on("chat_invitation_action", function (e) {
		ga("send", "event", "Chat", "chat_invitation" + e.data.action, e.data.source, 0)
	});
	LiveTex.on("chat_invitation_open", function (e) {
		ga("send", "event", "Chat", "chat_invitation_open", e.data.source, 0)
	});
	LiveTex.on("chat_open", function (e) {
		ga("send", "event", "Chat", "chat_open", e.data.source, 0)
	});
	LiveTex.on("chat_welcome_action", function (e) {
		ga("send", "event", "Chat", "chat_welcome" + e.data.action, "", 0)
	});
	LiveTex.on("chat_welcome_open", function (e) {
		ga("send", "event", "Chat", "chat_welcome_open", e.data.source, 0)
	});
	LiveTex.on("lead_action", function (e) {
		ga("send", "event", "Chat", "lead_" + e.data.action, e.data.source, 0)
	});
	LiveTex.on("lead_open", function (e) {
		ga("send", "event", "Chat", "lead_open", e.data.source, 0)
	});
	LiveTex.on("offline_action", function (e) {
		ga("send", "event", "Chat", "offline_" + e.data.action, e.data.source, 0)
	});
	LiveTex.on("offline_open", function (e) {
		ga("send", "event", "Chat", "offline_open", e.data.source, 0)
	})
};
MyAnalyticsClass.prototype.InitItemsView = function (mainlist, items) {
	MyAnalytics.GAInitItemsView(mainlist.data("listname"), items, mainlist.data("list_id"))
};
MyAnalyticsClass.prototype.GAInitItemsView = function (listname, items, list_id) {
	window.dataLayer = window.dataLayer || [];
	var view_item_list = [];
	items.each(function () {
		var _this = this;
		var product_catalog = {
			id: $(this).data("id"),
			name: $(this).data("name"),
			category: $(this).data("category"),
			brand: $(this).data("brand"),
			price: $(this).data("price"),
			list: listname,
			position: $(this).data("position")
		};
		// ga("ec:addImpression", product_catalog);
		view_item_list.push({
			item_name: $(_this).data("name"),
			item_id: $(_this).data("id"),
			price: $(_this).data("price"),
			currency: "UAH",
			item_brand: $(_this).data("brand"),
			item_category: $(_this).data("category"),
			item_list_name: listname,
			item_list_id: list_id,
			index: $(this).data("position"),
			quantity: 1
		});
		$(this).find(".item_link,.item_link_image").click(function () {
			var link = this;
			window.dataLayer.push({
				event: "select_item",
				ecommerce: {
					items: [{
						item_name: $(_this).data("name"),
						item_id: $(_this).data("id"),
						price: $(_this).data("price"),
						currency: "UAH",
						item_brand: $(_this).data("brand"),
						item_category: $(_this).data("category"),
						item_list_name: listname,
						item_list_id: list_id,
						index: $(_this).data("position"),
						quantity: 1
					}]
				}
			});
			var addProduct = new Array();
			addProduct = {
				id: $(_this).data("id"),
				name: $(_this).data("name"),
				category: $(_this).data("category"),
				brand: $(_this).data("brand"),
				price: $(_this).data("price"),
				position: $(_this).data("position")
			};
			ga("ec:addProduct", addProduct);
			ga("ec:setAction", "click", {
				list: listname
			});
			ga("send", "event", "UX", "click", "Results", {
				hitCallback: function () {
					document.location = link.href
				}
			});
			setTimeout(function () {
				document.location = link.href
			}, 2000);
			return !ga.loaded
		});
		$(this).find("a.buyButton").click(function () {
			window.dataLayer.push({
				event: "add_to_cart",
				ecommerce: {
					items: [{
						item_name: $(_this).data("name"),
						item_id: $(_this).data("id"),
						price: $(_this).data("price"),
						currency: "UAH",
						item_brand: $(_this).data("brand"),
						item_category: $(_this).data("category"),
						item_list_name: listname,
						item_list_id: list_id,
						index: $(_this).data("position"),
						quantity: 1
					}]
				}
			});
			return true
		})
	});
	if (view_item_list.length > 0) {
		window.dataLayer.push({
			event: "view_item_list",
			ecommerce: {
				items: view_item_list
			}
		})
	}
};


function InitGAEvents() {
	var has_ua = false,
		has_adtarget = true,
		has_fb = false;
	if (typeof (ga) != "undefined") {
		has_ua = true
	}
	if (typeof (fbq) != "undefined") {
		has_fb = true
	}
	$(".hproduct .itemImgBig .tozoom").click(function () {
		if (has_ua) {
			ga("send", "event", "Item", "ViewBigImage", "", 0)
		}
	});
	$(".hproduct .itemImg .tozoom").click(function () {
		if (has_ua) {
			ga("send", "event", "Item", "ViewSmallImage", "", 0)
		}
	});
	$(".hproduct .moneyDiv .remindBtn").click(function () {
		if (has_ua) {
			ga("send", "event", "WaitItem", "WaitItemClick", "", 0)
		}
	});
	$(".hproduct #tabs a").click(function () {
		if (has_ua) {
			ga("send", "event", "Item", "TabClick", this.rel, 0)
		}
	});
	$(".hproduct a.callMe").click(function () {
		if (has_ua) {
			ga("send", "event", "Item", "CallMe", this.rel, 0)
		}
	});
	$(".buyButton").click(function () {
		var parent = $(this).parents(".iteminfo:first");
		if (has_ua) {
			var add_to_card = new Array();
			add_to_card = {
				id: $(parent).data("id"),
				name: $(parent).data("name"),
				category: $(parent).data("category"),
				brand: $(parent).data("brand"),
				variant: "",
				coupon: $(parent).data("coupon"),
				price: $(parent).data("price"),
				quantity: 1
			};
			if (parent.hasClass("itemWrapper")) { }
			ga("ec:addProduct", add_to_card);
			ga("ec:setAction", "add");
			ga("send", "event", "Cart", "AddToCart", "", 0)
		}
		if (has_fb) {
			var parent = $(this).parents(".iteminfo:first");
			fbq("track", "AddToCart", {
				content_ids: [$(parent).data("id")],
				content_type: "product",
				value: $(parent).data("price"),
				currency: "UAH"
			})
		}
		if (typeof (hm) != "undefined") {
			hm.ab.goal("AddToCart")
		}
	});
	$(".catitems .remindBtn").click(function () {
		if (has_ua) {
			ga("send", "event", "WaitItem", "WaitItemClick", "", 0)
		}
	});
	$("#IconContacts").click(function () { });
	$("#IconMail").click(function () { });
	$("#enter_a").click(function () {
		if (has_ua) {
			ga("send", "event", "User", "LoginFormShow", "", 0)
		}
	});
	$("#headerloginform").submit(function () {
		if (has_ua) {
			ga("send", "event", "User", "TryLogin", "", 0)
		}
		return true
	});
	$(".itemsList").each(function () {
		MyAnalytics.InitItemsView($(this), $(this).find(".iteminfo"))
	})
}
MyAnalytics = new MyAnalyticsClass();